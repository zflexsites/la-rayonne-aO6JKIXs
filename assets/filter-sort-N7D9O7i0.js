import{f as x}from"./app-MoPn_2t3.js";let p=[],d=null;async function C(){return p=await x(),p}function h(s,n){const t=[...s];switch(n){case"price-asc":t.sort((e,r)=>e.price.amount-r.price.amount);break;case"price-desc":t.sort((e,r)=>r.price.amount-e.price.amount);break;case"name-asc":t.sort((e,r)=>e.title.localeCompare(r.title));break;case"name-desc":t.sort((e,r)=>r.title.localeCompare(e.title));break}return t}function I(s){const n=document.getElementById("product-grid");if(n){if(!d){const t=n.querySelector(".product-card");if(!t)return;d=t.cloneNode(!0)}if(n.innerHTML="",s.length===0){n.innerHTML='<p class="col-span-full text-center text-gray-500 py-8">Aucun produit ne correspond à votre sélection.</p>';return}s.forEach(t=>{if(!d)return;const e=d.cloneNode(!0),r=e.querySelector("a"),i=e.querySelector("img"),a=e.querySelector("h4"),l=e.querySelector(".product-price");if(r&&t.url&&(r.href=t.url),i&&(i.src=t.coverImage||"",i.alt=t.title),a&&(a.textContent=t.title),l&&t.price){const c=typeof t.price.amount=="number"?t.price.amount:0,u=t.price.currency||"EUR";l.textContent=`${c.toFixed(2)} ${u}`}n.appendChild(e)})}}async function L(){if(!document.getElementById("product-controls"))return;await C();const n=document.getElementById("zflex-data");if(!n||!n.textContent)return;const t=JSON.parse(n.textContent),e=t.category?t.category.id:null;if(!e)return;const r=p.filter(o=>o.categoryId===e),i=document.getElementById("sort-dropdown");if(!i)return;const a=document.getElementById("sort-btn"),l=document.getElementById("sort-label"),c=document.getElementById("sort-options");if(!a||!l||!c)return;const u=c.querySelectorAll(".sort-option");a.addEventListener("click",o=>{o.stopPropagation(),c.classList.toggle("hidden")}),u.forEach(o=>{o.addEventListener("click",f=>{f.preventDefault();const m=o,y=m.dataset.value||"",g=m.textContent||"";l.textContent=`Trier par : ${g}`,c.classList.add("hidden");const E=h(r,y);I(E)})}),document.addEventListener("click",o=>{i.contains(o.target)||c.classList.add("hidden")}),console.log("[FilterSort] Module initialisé.")}export{C as fetchProductIndex,L as initFilterSort};
